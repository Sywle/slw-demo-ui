{"ast":null,"code":"export default {\n  name: \"map3dView\",\n  data() {\n    return {\n      viewer3D: '',\n      findAllList: '',\n      isbackColor: 1,\n      token: 'eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyS2V5IjoiNzQ1NTcyOTU5NTc4MTQzIiwidXNlck5hbWUiOiJzdW5sZXdlbiIsInVzZXJUeXBlIjoiMSIsImFwcEtleSI6InU3NWNhMTU5NDU0YzRjYjE4NGJkMmYzNTJhYjI1MzEzIiwiYXBwTmFtZSI6IjM2MOW6lOeUqOaooeWeiyIsImFwcERiIjoidTc1Y2ExNTk0NTRjNGNiMTg0YmQyZjM1MmFiMjUzMTMiLCJsb2dpblRpbWUiOiIxNjg0Mjg3NTUyNjczIiwiZXhwIjowfQ.QwDOr3Ii88Sstt3-AOLmAH-OJLx9jgErS5FnCdT8QPE'\n    };\n  },\n  mounted() {\n    this.bos3d();\n  },\n  methods: {\n    bos3d() {\n      const html = document.querySelector(\"html\");\n      document.querySelector(\".viewport\").style.width = html.clientWidth + 'px';\n      document.querySelector(\".viewport\").style.height = html.clientHeight - 1 + 'px';\n      const option = {\n        host: \"http://bos3d.bimwinner.com\",\n        viewport: \"viewport\"\n      };\n      const viewer3D = new BOS3D.Viewer(option);\n      this.viewer3D = viewer3D;\n      new BOS3DUI({\n        viewer3D,\n        BOS3D: window.BOS3D\n        // 可选，需要显示哪些工具栏。默认都是true\n        // funcOption: {\n        //   init: true, // 初始化\n        //   fit: true, // 聚焦\n        //   undo: false, // 撤销\n        //   roam: true, // 漫游\n        //   pickByRect: false, // 框选\n        //   hide: false, // 隐藏\n        //   isolate: false, // 构件隔离\n        //   section: false, // 剖切\n        //   wireFrame: false, // 线框化\n        //   scatter: false, // 模型分解\n        //   changeCptColor: false, // 构件变色\n        //   setting: false, // 设置\n        //   fullScreen: false, // 全屏\n        //   changeBgColor: false, // 改变背景色\n        //   cptInfo: false, // 构件信息\n        //   infoTree: false, // 结构树\n        //   measure: false, // 测量\n        //   mark: false, // 标签\n        //   snapshot: false, // 快照\n        //   annotation: false, // 批注\n        //   reset:true, //复位\n        //   moreMenu:false //更多\n        // }\n      });\n      // 添加视图\n      // modelKey:模型key\n      // projectKey:项目key\n      viewer3D.addView(\"M1683872392915\", \"z4d121fa350247caa738ca56497844ac\", this.token);\n      viewer3D.addView(\"M1683879955261\", \"z4d121fa350247caa738ca56497844ac\", this.token);\n      // ON_LOAD_COMPLETE：加载完成\n      viewer3D.registerModelEventListener(window.BOS3D.EVENTS.ON_LOAD_COMPLETE, event => {\n        // key:构件key\n        // 通过key进行控件旋转\n        viewer3D.rotateComponentByKey(\"M1683872392915_2fe5XPmKnFnhnF3PtNQVTR\");\n        // 设置物项位置\n        // viewer3D.setModelMatrix('M1683872392915', new BOS3D.THREE.Matrix4().set(\n        //   1, 0, 0, 0,\n        //   0, 1, 0, 0,\n        //   0, 0, 1, 0,\n        //   0, 0, 0, 1\n        // ))\n        viewer3D.setModelMatrix('M1683879955261', new BOS3D.THREE.Matrix4().set(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1));\n        let findAllByKey = viewer3D.getAllComponentsKey();\n        let findAll = viewer3D.getComponentsByKey(findAllByKey);\n        this.findAllList = findAll.length;\n      });\n      // 单击事件\n      viewer3D.registerModelEventListener(window.BOS3D.EVENTS.ON_CLICK_PICK, event => {\n        console.log(\"event：\", event);\n      });\n      // 加载模型监听函数\n      viewer3D.registerModelEventListener(BOS3D.EVENTS.ON_LOAD_ERROR, event => {\n        alert(\"模型加载异常监听\");\n        this.getInfo();\n      });\n    },\n    fullscreen() {\n      const state = BOS3D.FullScreen.fullScreen(document.getElementById('viewport'));\n      console.log(state);\n    },\n    // 更改背景色\n    changeBackgroundColor() {\n      if (this.isbackColor === 1) {\n        this.viewer3D.setSceneBackGroundColor('#FFFFFF', 0.1);\n      } else if (this.isbackColor === 2) {\n        this.viewer3D.setSceneBackGroundColor('red', 0.1);\n      } else if (this.isbackColor === 3) {\n        this.viewer3D.setSceneBackGroundColor('blue', 0.1);\n      } else if (this.isbackColor === 4) {\n        this.viewer3D.setSceneBackGroundColor('green', 0.1);\n      }\n      if (this.isbackColor === 4) {\n        this.isbackColor = 1;\n      } else {\n        this.isbackColor++;\n      }\n    },\n    getInfo() {\n      let xhr = new XMLHttpRequest();\n      xhr.onreadystatechange = function () {\n        if (this.readyState === 4) {\n          if (this.status === 200) {\n            console.log(JSON.parse(this.response).data);\n            this.token = JSON.parse(this.response).data.access_token;\n          }\n        }\n      };\n      xhr.open('POST', ' http://bosgw.bimwinner.com/bospersonnelservice/u75ca159454c4cb184bd2f352ab25313/users/login', true);\n      xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\n      xhr.send('name=sunlewen&password=sun12345');\n    }\n  }\n};","map":{"version":3,"names":["name","data","viewer3D","findAllList","isbackColor","token","mounted","bos3d","methods","html","document","querySelector","style","width","clientWidth","height","clientHeight","option","host","viewport","BOS3D","Viewer","BOS3DUI","window","addView","registerModelEventListener","EVENTS","ON_LOAD_COMPLETE","event","rotateComponentByKey","setModelMatrix","THREE","Matrix4","set","findAllByKey","getAllComponentsKey","findAll","getComponentsByKey","length","ON_CLICK_PICK","console","log","ON_LOAD_ERROR","alert","getInfo","fullscreen","state","FullScreen","fullScreen","getElementById","changeBackgroundColor","setSceneBackGroundColor","xhr","XMLHttpRequest","onreadystatechange","readyState","status","JSON","parse","response","access_token","open","setRequestHeader","send"],"sources":["src/views/map3dView.vue"],"sourcesContent":["<template>\n  <div>\n    <div class=\"box\">\n      <img src=\"http://smlstatic.hismartlab.club/fwslogo5.png\" style=\"width: 44px;height: 28px\" alt=\"\">\n      <div style=\"fontSize: 25px;fontWeight: 700; color: #fff\">数字空间管理平台</div>\n      <el-button @click=\"fullscreen\">全屏</el-button>\n      <el-button @click=\"changeBackgroundColor\">变底色</el-button>\n      <el-button @click=\"getInfo\">请求</el-button>\n      <span>一共获取了 {{ findAllList }} 条模型数据！</span>\n    </div>\n    <div id=\"viewport\" class=\"viewport\"></div>\n  </div>\n</template>\n\n<script>\nexport default ({\n  name: \"map3dView\",\n  data() {\n    return {\n      viewer3D: '',\n      findAllList: '',\n      isbackColor: 1,\n      token: 'eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyS2V5IjoiNzQ1NTcyOTU5NTc4MTQzIiwidXNlck5hbWUiOiJzdW5sZXdlbiIsInVzZXJUeXBlIjoiMSIsImFwcEtleSI6InU3NWNhMTU5NDU0YzRjYjE4NGJkMmYzNTJhYjI1MzEzIiwiYXBwTmFtZSI6IjM2MOW6lOeUqOaooeWeiyIsImFwcERiIjoidTc1Y2ExNTk0NTRjNGNiMTg0YmQyZjM1MmFiMjUzMTMiLCJsb2dpblRpbWUiOiIxNjg0Mjg3NTUyNjczIiwiZXhwIjowfQ.QwDOr3Ii88Sstt3-AOLmAH-OJLx9jgErS5FnCdT8QPE'\n    }\n  },\n  mounted() {\n    this.bos3d()\n  },\n  methods: {\n    bos3d() {\n      const html = document.querySelector(\"html\");\n      document.querySelector(\".viewport\").style.width = html.clientWidth + 'px';\n      document.querySelector(\".viewport\").style.height = html.clientHeight - 1 + 'px';\n      const option = {host: \"http://bos3d.bimwinner.com\", viewport: \"viewport\"};\n      const viewer3D = new BOS3D.Viewer(option);\n      this.viewer3D = viewer3D\n      new BOS3DUI({\n        viewer3D,\n        BOS3D: window.BOS3D,\n        // 可选，需要显示哪些工具栏。默认都是true\n        // funcOption: {\n        //   init: true, // 初始化\n        //   fit: true, // 聚焦\n        //   undo: false, // 撤销\n        //   roam: true, // 漫游\n        //   pickByRect: false, // 框选\n        //   hide: false, // 隐藏\n        //   isolate: false, // 构件隔离\n        //   section: false, // 剖切\n        //   wireFrame: false, // 线框化\n        //   scatter: false, // 模型分解\n        //   changeCptColor: false, // 构件变色\n        //   setting: false, // 设置\n        //   fullScreen: false, // 全屏\n        //   changeBgColor: false, // 改变背景色\n        //   cptInfo: false, // 构件信息\n        //   infoTree: false, // 结构树\n        //   measure: false, // 测量\n        //   mark: false, // 标签\n        //   snapshot: false, // 快照\n        //   annotation: false, // 批注\n        //   reset:true, //复位\n        //   moreMenu:false //更多\n        // }\n      })\n      // 添加视图\n      // modelKey:模型key\n      // projectKey:项目key\n      viewer3D.addView(\"M1683872392915\", \"z4d121fa350247caa738ca56497844ac\", this.token);\n      viewer3D.addView(\"M1683879955261\", \"z4d121fa350247caa738ca56497844ac\", this.token);\n      // ON_LOAD_COMPLETE：加载完成\n      viewer3D.registerModelEventListener(window.BOS3D.EVENTS.ON_LOAD_COMPLETE, (event) => {\n        // key:构件key\n        // 通过key进行控件旋转\n        viewer3D.rotateComponentByKey(\"M1683872392915_2fe5XPmKnFnhnF3PtNQVTR\");\n        // 设置物项位置\n        // viewer3D.setModelMatrix('M1683872392915', new BOS3D.THREE.Matrix4().set(\n        //   1, 0, 0, 0,\n        //   0, 1, 0, 0,\n        //   0, 0, 1, 0,\n        //   0, 0, 0, 1\n        // ))\n        viewer3D.setModelMatrix('M1683879955261', new BOS3D.THREE.Matrix4().set(\n          1, 0, 0, 0,\n          0, 1, 0, 0,\n          0, 0, 1, 0,\n          0, 0, 0, 1\n        ))\n        let findAllByKey = viewer3D.getAllComponentsKey();\n        let findAll = viewer3D.getComponentsByKey(findAllByKey);\n        this.findAllList = findAll.length\n      })\n      // 单击事件\n      viewer3D.registerModelEventListener(window.BOS3D.EVENTS.ON_CLICK_PICK, (event) => {\n        console.log(\"event：\", event)\n      })\n      // 加载模型监听函数\n      viewer3D.registerModelEventListener(BOS3D.EVENTS.ON_LOAD_ERROR, (event) => {\n          alert(\"模型加载异常监听\")\n          this.getInfo()\n      });\n    },\n    fullscreen() {\n      const state = BOS3D.FullScreen.fullScreen(document.getElementById('viewport'));\n      console.log(state)\n    },\n    // 更改背景色\n    changeBackgroundColor() {\n      if(this.isbackColor === 1) {\n        this.viewer3D.setSceneBackGroundColor('#FFFFFF', 0.1);\n      } else if(this.isbackColor === 2) {\n        this.viewer3D.setSceneBackGroundColor('red', 0.1);\n      } else if(this.isbackColor === 3) {\n        this.viewer3D.setSceneBackGroundColor('blue', 0.1);\n      } else if(this.isbackColor === 4) {\n        this.viewer3D.setSceneBackGroundColor('green', 0.1);\n      }\n      if(this.isbackColor === 4) {\n        this.isbackColor = 1\n      } else {\n        this.isbackColor ++\n      }\n    },\n    getInfo() {\n      let xhr = new XMLHttpRequest()\n      xhr.onreadystatechange = function () {\n        if(this.readyState === 4) {\n          if(this.status === 200) {\n            console.log(JSON.parse(this.response).data);\n            this.token = JSON.parse(this.response).data.access_token\n          }\n        }\n      }\n      xhr.open('POST', ' http://bosgw.bimwinner.com/bospersonnelservice/u75ca159454c4cb184bd2f352ab25313/users/login', true)\n      xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\n      xhr.send('name=sunlewen&password=sun12345')\n    },\n  }\n})\n</script>\n<style scoped>\nbody {\n  margin: 0;\n  overflow: hidden;\n  position: fixed;\n}\n.box {\n  width: 100%;\n  display: flex;\n  justify-content: flex-start;\n  align-items: center;\n  background: #ccc;\n}\n.viewport {\n  height: calc(100vh - 61px)!important;\n}\n</style>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}